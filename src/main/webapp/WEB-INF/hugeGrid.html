<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>大数据测试</title>
    <script charset="UTF-8" src="asset/jquery.js"></script>
    <script charset="UTF-8" src="asset/underscore.js"></script>
    <script charset="UTF-8" src="asset/hugeGrid/template-util.js"></script>
    <script charset="UTF-8" src="asset/hugeGrid/ouiGrid.js"></script>
    <link rel="stylesheet" type="text/css" href="asset/hugeGrid/css/ouiGrid.css">
    <script charset="UTF-8" src="asset/hugeGrid/testData.js"></script>
    <script charset="UTF-8" src="asset/hugeGrid/hugeGrid.js"></script>

    <!--
        depends: [renderModel, gridInstance]
        renderModel = {
            colModel: [...],
            colName: [...]
        }
        gridInstance: {object}
    -->
    <script id="ouiGridTemplate" type="text/template">
        [% var gridClass = gridInstance.gridClass(renderModel); %]
        [% var gridStyle = gridInstance.gridStyle(renderModel); %]
        <div class="[%= gridClass %]" style="[%= gridStyle%]">
            [% var headClass = gridInstance.headClass(renderModel); %]
            [% var headStyle = gridInstance.headStyle(renderModel); %]
            <div class="[%= headClass %]" style="[%= headStyle %]">
                [% var headBoxClass = gridInstance.headBoxClass(renderModel); %]
                [% var headBoxStyle = gridInstance.headBoxStyle(renderModel); %]
                <div class="[%= headBoxClass %]" style="[%= headBoxStyle %]">
                    [% var headTableClass = gridInstance.headTableClass(renderModel); %]
                    [% var headTableStyle = gridInstance.headTableStyle(renderModel); %]
                    <table class="[%= headTableClass %]" style="[%= headTableStyle %]">
                        <thead>
                        [% var templateRowClass = gridInstance.templateRowClass(renderModel); %]
                        [% var headTableStyle = gridInstance.templateRowStyle(renderModel); %]
                        <tr class="grid-template-row">
                            [% var colName = renderModel.colName; %]
                            [% var colModel = renderModel.colModel; %]
                            [% for (var key in colName) { %]
                            [%      var cellModel = colModel[key]; %]
                            [%      var templateCellClass = gridInstance.templateCellClass(cellModel); %]
                            [%      var templateCellStyle = gridInstance.templateCellStyle(cellModel); %]
                            <th data-name="[%= cellModel.name %]"
                                class="[%= templateCellClass %]"
                                style="[%= templateCellStyle %]"
                            >
                            </th>
                            [% } %]
                        </tr>
                        <tr>
                            [% var colName = renderModel.colName; %]
                            [% var colModel = renderModel.colModel; %]
                            [% for (var key in colName) { %]
                            [%      var cellClass = gridInstance.headCellClass(colModel[key]); %]
                            [%      var cellStyle = gridInstance.headCellStyle(colModel[key]); %]
                            <th data-name="[%= colModel[key].name %]"
                                class="[%= cellClass %]"
                                style="[%= cellStyle %]"
                            >
                                [%= colName[key] %]
                            </th>
                            [% } %]
                        </tr>
                        </thead>
                    </table>
                </div>
            </div>

            [% var bodyClass = gridInstance.bodyClass(renderModel); %]
            [% var bodyStyle = gridInstance.bodyStyle(renderModel); %]
            <div class="[%= bodyClass %]" style="[%= bodyStyle %]">
                [% var bodyTableClass = gridInstance.bodyTableClass(renderModel); %]
                [% var bodyTableStyle = gridInstance.bodyTableStyle(renderModel); %]
                <table class="[%= bodyTableClass %]" style="[%= bodyTableStyle %]">
                    <tr class="grid-template-row">
                        [% var colName = renderModel.colName; %]
                        [% var colModel = renderModel.colModel; %]
                        [% for (var key in colName) { %]
                        [%      var cellModel = colModel[key]; %]
                        [%      var templateCellClass = gridInstance.templateCellClass(cellModel); %]
                        [%      var templateCellStyle = gridInstance.templateCellStyle(cellModel); %]
                        <td data-name="[%= cellModel.name %]"
                            class="[%= templateCellClass %]"
                            style="[%= templateCellStyle %]"
                        >
                        </td>
                        [% } %]
                    </tr>
                </table>
            </div>
        </div>
    </script>

    <!--
        depends: [rowDataList, renderModel, gridInstance]
        renderPageModel: {
            startIndex: {number},
            endIndex: {number},
            pageData: [...]
        },
        gridInstance: {{object}}}
    -->
    <script id="outGridDataTemplate" type="text/template">
        [% var rowDataList =  renderPageModel.pageData; %]
        [% for(var i = 0, length = rowDataList.length; i < length; i++) { %]

            [% var rowData = rowDataList[i]; %]
            [% var rowId = rowData[renderModel.keyName]; %]
            [% var rowAttr = gridInstance.rowAttr(rowData, rowId); %]
            [% var rowClass = gridInstance.rowClass(rowData, rowId); %]
            [% var rowStyle = gridInstance.rowStyle(rowData, rowId); %]

        <tr id="[%= rowData[renderModel.keyName] %]"
            [%= rowAttr %]
            class="[%= rowClass %]"
            style="[%= rowStyle %]"
        >
            [% colModel = renderModel.colModel; %]
            [% for (var j in colModel) { %]
            [%      var colName = colModel[j]["name"]; %]
            [%      var cellModel = colModel[j]; %]
            [%      var cellValue = rowData[colName]; %]
            [%      var cellAttr = gridInstance.cellAttr(cellModel, cellValue, rowData, rowId); %]
            [%      var cellClass = gridInstance.cellClass(cellModel, cellValue, rowData, rowId); %]
            [%      var cellStyle = gridInstance.cellStyle(cellModel, cellValue, rowData, rowId); %]
            [%      var cellFormatValue = gridInstance.format(cellModel, cellValue, rowData, rowId); %]
            <td data-name="[%= colName %]"
                [%= cellAttr %]
                class="[%= cellClass %]"
                style="[%= cellStyle %]"
            >
                [%= colName !== "_rowNumber" ? cellFormatValue : (renderPageModel.startIndex + i + 1) %]
            </td>
            [% } %]
        </tr>
        [% } %]
    </script>
</head>
<body>
<div id="grid">

</div>

</body>
</html>